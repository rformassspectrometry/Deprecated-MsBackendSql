<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SQL database based mass spectrometry data backend — MsBackendSqlDb • MsBackendSql</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="SQL database based mass spectrometry data backend — MsBackendSqlDb" />
<meta property="og:description" content="The MsBackendSqlDb is an MsBackend backend that keeps all
metadata and spectra data (m/z and intensity values) in a single
on-disk database table.  This object has a very low memory
footprint because only primary keys of the database table are
stored in memory, within the object hence making it ideal for
representing very large mass spectrometry data sets on computers
with limited resources." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsBackendSql</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MsBackendSqlDb.html">Description and usage of MsBackendSqlDb</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/MsBackendSql/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SQL database based mass spectrometry data backend</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/MsBackendSql/blob/master/R/MsBackendSqlDb-functions.R'><code>R/MsBackendSqlDb-functions.R</code></a>, <a href='https://github.com/RforMassSpectrometry/MsBackendSql/blob/master/R/MsBackendSqlDb.R'><code>R/MsBackendSqlDb.R</code></a></small>
    <div class="hidden name"><code>MsBackendSqlDb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>MsBackendSqlDb</code> is an MsBackend backend that keeps all
metadata and spectra data (m/z and intensity values) in a single
on-disk database table.  This object has a very low memory
footprint because only primary keys of the database table are
stored in memory, within the object hence making it ideal for
representing very large mass spectrometry data sets on computers
with limited resources.</p>
    </div>

    <pre class="usage"><span class='fu'>MsBackendSqlDb</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># S4 method for MsBackendSqlDb</span>
<span class='fu'>backendInitialize</span><span class='op'>(</span>
  <span class='va'>object</span>,
  files <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='fu'>DataFrame</span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>...</span>,
  <span class='va'>dbcon</span>,
  dbtable <span class='op'>=</span> <span class='st'>"msdata"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a <code>MsBackendSqlDb</code> object.</p></td>
    </tr>
    <tr>
      <th>files</th>
      <td><p><code>character</code> with the file names from which data should
be imported. Only required if the database to which <code>dbcon</code>
connects does not already contain the data.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>For <code>backendInitialize</code>: <code>DataFrame</code> with spectrum
metadata/data from which data should be imported. This parameter
is the alternative of <code>files</code> parameter, only required if the
database to which <code>dbcon</code> connects does not already contain the
data, and the data is not from MS data files.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments.</p></td>
    </tr>
    <tr>
      <th>dbcon</th>
      <td><p>a <code>DBIConnection</code> object to connect to the database. If
not provided, <code>backendInitialize</code>method will create a <code>DBIConnection</code>
object in the temporary directory of R.</p></td>
    </tr>
    <tr>
      <th>dbtable</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> the name of the database table with
the data.  Defaults to <code>dbtable = "msdata"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>dbtable</code></dt><dd><p>A <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the name of the database table
(or view) containing the data.</p></dd>

<dt><code>dbcon</code></dt><dd><p>A <code>DBIConnection</code> with the connection to the database.</p></dd>

<dt><code>modCount</code></dt><dd><p>An <code><a href='https://rdrr.io/r/base/integer.html'>integer()</a></code> that keeps track of each database
writing cycle which would invalidate objects pointing to the
same database. This number has to match between the database
and the object.</p></dd>

<dt><code>rows</code></dt><dd><p>An <code><a href='https://rdrr.io/r/base/integer.html'>integer()</a></code> with the indices (primary keys) of the
data.</p></dd>

<dt><code>columns</code></dt><dd><p>A <code><a href='https://rdrr.io/r/base/character.html'>character()</a></code> containing the names of the columns
stored in the database.</p></dd>

<dt><code>`query`</code></dt><dd><p>A <code>DBIResults</code> object containing SQL query against
the backend.</p></dd>

</dl>
    <h2 class="hasAnchor" id="creating-an-msbackendsqldb-instance"><a class="anchor" href="#creating-an-msbackendsqldb-instance"></a>Creating an <code>MsBackendSqlDb</code> instance</h2>

    


<p>Like all <code>MsBackend()</code> objects, <code>MsBackendSqlDb</code> have to be
<em>initialized</em> with the <code>backendInitialize()</code> method. There are three
ways to initialize a <code>MsBackendSqlDb</code> object by <code>backendInitialize()</code>
method. We can either fill the object with data from mass spectrometry
files provided with the <code>files</code> parameter, or we can pass a <code>DataFrame</code>
object with metadata and spectra data with the <code>data</code> parameter, or
checks if the pre-generated database contains all required data. A
connection to a database (with write access) has to be provided with
the <code>dbcon</code> parameter which expects a <code>DBIConnection</code> returned by a
call to <code>dbConnect()</code>. To fill the database with MS data files (usually
mzML files, but all files types supported by the <code>mzR</code> package are
allowed), these have to be provided with the <code>files</code> parameter. Or, we
can pass a <code>DataFrame</code> object to the database through the <code>DBIConnection</code>
object. This <code>DataFrame</code> shall contain the metadata and spectra data parsed
by other backends, or generated by by user themselves. Parameter <code>dbtable</code>
can be used to optionally specify the database table name that contains,
or should contain the data.</p>
    <h2 class="hasAnchor" id="implementation-notes"><a class="anchor" href="#implementation-notes"></a>Implementation notes</h2>

    


<p>The <code>MsBackendSqlDb</code> defines the following slots which should not
be accessed or changed by the user.</p>
    <h2 class="hasAnchor" id="backend-functions"><a class="anchor" href="#backend-functions"></a>Backend functions</h2>

    


<p>MsBackendSqlDb extend the base <code>MsBackend</code> class from Spectra package.
Currently, MsBackendSqlDb supports all the reading functions from <code>MsBackend</code>
class. Only specific functions in MsBackendSqlDb will be listed:</p><ul>
<li><p><code>reset</code> the row indices of a MsBackendSqlDb backend after filtering
and/or subsetting operations. MsBackendSqlDb backend utilizes slot <code>rows</code>
to mark filtering and subsetting results. The underlying SQLite data tables
won't be influenced by these operations.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Chong Tang, Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Initialize an MsBackendSqlDb filling it with data from mzML files</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>msdata</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rsqlite.r-dbi.org'>RSQLite</a></span><span class='op'>)</span>
<span class='va'>con</span> <span class='op'>&lt;-</span> <span class='fu'>dbConnect</span><span class='op'>(</span><span class='fu'><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>SQLite</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>fls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"sciex"</span>, package <span class='op'>=</span> <span class='st'>"msdata"</span><span class='op'>)</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span>,
    pattern <span class='op'>=</span> <span class='st'>"mzML$"</span><span class='op'>)</span>
<span class='va'>msb</span> <span class='op'>&lt;-</span> <span class='fu'>backendInitialize</span><span class='op'>(</span><span class='fu'>MsBackendSqlDb</span><span class='op'>(</span><span class='op'>)</span>, dbcon <span class='op'>=</span> <span class='va'>con</span>, files <span class='op'>=</span> <span class='va'>fls</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by RforMassSpectrometry Package Maintainer, Johannes Rainer, Chong Tang, Laurent Gatto, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


